---
import BestRoastLayout from "../layouts/BestRoastLayout.astro";

export const prerender = true;

import { fetchPageData, fetchTopRatedRoasts } from "../lib/graphql";
import { organiseComments } from "../lib/utils";

const pageId = "5610";
const singlePage = await fetchPageData(pageId);
const { topRated, highRated } = await fetchTopRatedRoasts("West London");

const threadedComments = organiseComments(singlePage.comments.nodes);
---

<BestRoastLayout
  pageTitle={singlePage.title}
  description={singlePage?.seo?.opengraphDescription}
  opengraphImage={singlePage?.seo?.opengraphImage?.sourceUrl}
  content={singlePage.content}
  topRated={topRated}
  highRated={highRated}
  threadedComments={threadedComments}
  postId={singlePage.pageId}
/>
